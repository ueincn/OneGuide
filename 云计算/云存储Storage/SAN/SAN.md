**存储区域网络(Storage Area Network，SAN)**

存储区域网络是一种面向网络的存储结构，是以数据存储为中心的。SAN采用可扩展的网络拓扑结构连接服务器和存储设备，并将数据的存储和管理集中在相对独立的专用网络中，面向服务器提供数据存储服务。服务器和存储设备之间的多路、可选择的数据交换消除了以往存储结构在可扩展性和数据共享方面的局限性。

通过协议映射，SAN中存储设备的磁盘或磁带表现为服务器节点上的“网络磁盘”。在服务器操作系统看来，这些网络盘与本地盘一样，服务器节点就像操作本地SCSI硬盘一样对其发送SCSI命令。SCSI命令通过FCP、iSCSI、SEP等协议的封装后，由服务器发送到SAN网络，然后由存储设备接收并执行。服务器节点可以对“网络磁盘”进行各种块操作，包括FDISK、FORMAT等，也可以进行文件操作，如复制文件、创建目录等。

SAN是企业最常用的存储网络架构，要求高吞吐量和低延迟的业务关键型业务往往采用这类架构运行。如今，采用全闪存存储的 SAN 部署数量增速迅猛。与旋转磁盘相比，全闪存存储可提供更出色的性能、稳定一致的低延迟以及更低的总成本。SAN 将数据存储在集中式共享存储中，使企业能够运用一致的方法和工具来实施安全防护、数据保护和灾难恢复。

SAN 是一种基于块的存储，利用高速架构将服务器与其逻辑磁盘单元 (Logical Disk Unit, LUN) 相连。LUN 是一系列通过共享存储池配置的块，以逻辑磁盘的形式呈现给服务器。服务器会对这些块进行分区和格式化，通常使用文件系统，以便可以像在本地磁盘存储上一样在 LUN 上存储数据。
SAN约占网络存储市场总额的三分之二。SAN 的设计可消除单点故障，因此具有极高的可用性和故障恢复能力。设计完善的SAN 可以轻松承受多个组件或设备的故障。

**SAN 的类型**

最常见的 SAN 协议包括：

1. **光纤通道协议 (Fibre Channel Protocol, FCP)。**
    应用最为广泛的 SAN 或块协议，部署量占 SAN 市场总额的 70% 到 80%。FCP 使用具有嵌入式 SCSI 命令的光纤通道传输协议。

2. **Internet 小型计算机系统接口 (iSCSI)。**
   第二大 SAN 或块协议，约占 10% 至 15% 的市场份额。iSCSI 将 SCSI 命令封装在以太网帧内，然后使用 IP 以太网络进行传输。

3. **以太网光纤通道 (Fibre Channel over Ethernet, FCoE)。**
   FCoE 占 SAN 市场的份额不到 5%。它与 iSCSI 类似，将 FC 帧封装在以太网数据报中，然后像 iSCSI 一样使用 IP 以太网络进行传输。

4. **基于光纤通道的非易失性内存标准 (Non-Volatile Memory Express over Fibre Channel, FC-NVMe)。**
   NVMe 是一款用于通过 PCI Express (PCIe) 总线访问闪存存储的接口协议

### Link

- MBA·智库百科：[https://wiki.mbalib.com/wiki/SAN](https://wiki.mbalib.com/wiki/SAN)

- 百度百科：[https://baike.baidu.com/item/存储区域网络](https://baike.baidu.com/item/%E5%AD%98%E5%82%A8%E5%8C%BA%E5%9F%9F%E7%BD%91%E7%BB%9C/6091260)

### SAN和NAS对比

第一，从**网络架构来说**，本质区别在于：NAS直接使用TCP/IP传输数据。SAN使用SCSI或iSCSI协议传输数据。

第二，从**文件读写实现方法上来说**，本质区别在于：**NAS采用了NFS和 CIFS技术实现文件共享**。说明NAS是基于操作系统的“文件级”读写操作。SAN中计算机和存储间的接口是底层的块协议，它按照协议头的“块地址+偏移地址”来定位。共享的存储和前端的操作系统类型没有关系，任何服务器操作系统，都可以正常识别。

| **存储结构/性能对比** | **DAS** | **NAS** | **FC-SAN** | **IP-SAN** |
| --- | --- | --- | --- | --- |
| 成本 | 低 | 较低 | 高 | 较高 |
| 数据传输速度 | 快 | 慢 | 极快 | 较快 |
| 扩展性 | 无扩展性 | 较低 | 易于扩展 | 最易扩展 |
| 服务器访问存储方式 | 直接访问存储数据块 | 以文件方式访问  | 直接访问存储数据块 | 直接访问存储数据块 |
| 服务器系统性能开销  | 低 | 较低 | 低 | 较高 |
| 安全性 | 高 | 低 | 高 | 低 |
| 是否集中管理存储 | 否 | 是 | 是 | 是 |
| 备份效率 | 低 | 较低 | 高 | 较高 |
| 网络传输协议 | 无 | TCP/IP  | Fibre Channel  | TCP/IP |

SAN存储分为iSCSI存储（iSCSI Storage）和FC存储（FC Storage）SAN存储分为iSCSI存储（iSCSI Storage）和FC存储（FC Storage）：
iSCSI存储（iSCSI Storage）：基于iSCSI协议构建的SAN存储。用户可将iSCSI存储上划分的块设备添加为Shared Block主存储，或直接透传给云主机使用。

FC存储（FC Storage）：基于FC协议构建的SAN存储。用户可将FC存储上划分的块设备添加为Shared Block主存储，或直接透传给云主机使用

**应用场景**
- 将iSCSI磁盘或FC磁盘直接透传给云主机使用。
- 以共享块的方式，将iSCSI磁盘或FC磁盘添加为Shared Block主存储。

**注意事项**
- iSCSI存储：
  - 未被加载到云主机的磁盘，支持添加为Shared Block主存储。
  - 添加为主存储的LUN不可用于其他用途。
  - 未添加为主存储的磁盘支持加载到云主机。
  - 一个磁盘支持加载到多个云主机，一个云主机支持加载多个磁盘。

- FC存储：**
  - 集群状态正常且未被加载到云主机的块设备，支持添加为Shared Block主存储。
  - 添加为主存储的LUN不可用于其他用途。
  - 未添加为主存储的块设备支持加载到云主机。
  - 一个块设备支持加载到多个云主机，一个云主机支持加载多个块设备。
